# -*- coding: utf-8 -*-
"""Sales Prediction using Python

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1C2sBWNBYerzFA1daX5i6SJo5a_4a69pT
"""

import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split,GridSearchCV,cross_val_score,KFold
from sklearn.linear_model import LogisticRegression,Ridge,Lasso
from sklearn.metrics import mean_squared_error,mean_absolute_error,r2_score

df=pd.read_csv('/content/sample_data/Advertising.csv')

df

df.sample(8)

df.sample

df.shape

df.isnull()

df.isnull().sum()

df.columns

df.drop(columns=['Unnamed: 0'],axis=1,inplace=True)

df

df.shape

df.info()

df.size

df.dtypes

df.describe()

df.duplicated()

df.duplicated().sum()

plt.figure(figsize=[5,3])
plt.boxplot(df,vert=False,data=df,labels=df.columns)
plt.show()

sns.histplot(df['TV'])

sns.histplot(df['Newspaper'])

sns.histplot(df['Radio'])

sns.histplot(df['Sales'])

sns.distplot(df['Newspaper'])

sns.distplot(df['TV'])

sns.distplot(df['Sales'])

sns.pairplot(df)

sns.heatmap(df.corr(),annot=True)

x=df.iloc[:,0:-1]
x

y=df.iloc[:,-1]

xtrain,xtest,ytrain,ytest=train_test_split(x,y,test_size=3,random_state=0)

print(x.shape)
print(xtrain.shape)
print(xtest.shape)

xtrain,ytrain

xtest,ytest

from sklearn.linear_model import LinearRegression

model=LinearRegression()
model.fit(xtrain,ytrain)

ypredict=model.predict(xtest)
ypredict

model.score(xtrain,ytrain)*100

model.score(xtest,ytest)*100

mean_squared_error(ytest,ypredict)

mean_absolute_error(ytest,ypredict)

r2_score(ytest,ypredict)*100

plt.scatter(ytest,ypredict,c='g')